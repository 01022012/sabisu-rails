<div class="row">
   <div class="col-2">
    <h1>Resources</h1>
    <ul class="navigation">
    <% @resources.each do |resource| %>
      <li><%= link_to resource.capitalize, explorer_path(explorer: { resource: resource }) %></li>
    <% end %>
    </ul>
   </div>
   <div class="col-10">
    <h1>Api explorer</h1>

    <div class="row">
       <div class="col-2">
         <span class="text-muted"><%= "/#{@explorer.resource}/" %></span>
       </div>
       <div class="col-10">

         <%= form_for :explorer, url: explorer_path, method: :get do |f| %>
           <%= f.hidden_field :resource, value: @explorer.resource %>
           <%= f.text_field :uri_pattern, value: @explorer.uri_pattern %>
           <%= f.select :http_method, options_for_select(Sabisu.http_methods, @explorer.http_method.upcase) %>

           <fieldset>
             <legend><%= @explorer.resource_class %> attributes</legend>
             <% @explorer.resource_attributes.each do |attribute| %>
               <%= f.label attribute, label_attribute(@explorer, attribute) %>
             <%= f.text_field attribute, name: "#{@explorer.resource_name}[#{attribute}]" %>
           <% end %>
           </fieldset>
           <%= f.submit "Send", class: 'button pill danger'%>
         <% end %>

         <table>
           <tr>
             <th>Name</th>
             <th>Type</th>
             <th>Default</th>
             <th>Required</th>
           </tr>
           <% @explorer.resource_columns.each do |column| %>
             <tr>
             <td><%= column.name %></td>    
             <td><%= column.type %></td>    
             <td><%= column.default || "NULL" %></td>    
             <td><%= @explorer.required_attribute? column.name %></td>    
           </tr>
         <% end %>
         </table>
       </div>
    </div>

    <h3>Response status: <span class="text-success"><%= @response.code %></span></h3>

    <div class="row" id="result">
      
    </div>
    <div class="row" id="headers_result">
      
    </div>
   </div>
</div>

<%= content_for :javascripts do %>
  <script type="text/javascript" charset="utf-8">
    $(document).ready(function(){
        $.JSONView(<%= @response.body.html_safe %>, $('#result'));
        $.JSONView(<%= @response.headers.to_json.html_safe %>, $('#headers_result'));
    });
  </script>
<% end %>
